#!/usr/bin/env bash

export VAGRANT_DEFAULT_PROVIDER="aws"

function main {
  local shome="$(cd -P -- "${BASH_SOURCE%/*}/.." && pwd -P)"

  source "$shome/script/profile"

  case "${1:-}" in
    add)
      local nm_action="$1"; shift
      local nm_image="$1"; shift
      exec parity "$nm_action" "$nm_image" "$nm_image" "$@"
      ;;
    *)
      if [[ -x "$(which "parity-${1:-}" 2>&- || true)" ]]; then
        exec parity "$@"
      else
        exec "$shome/vendor/virtualenv/bin/aws" "$@"
      fi
      ;;
  esac
}

source sub "$0" "$@"
